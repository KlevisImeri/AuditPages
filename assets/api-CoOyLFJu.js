const s="https://api.shkf-ks.org/api",h=()=>localStorage.getItem("authToken"),p=()=>{const r=h();return r?{"Content-Type":"application/json",Authorization:`Bearer ${r}`}:{"Content-Type":"application/json"}},c=async(r,e={})=>{const o=p(),a={...e,headers:o},n=await fetch(r,a);if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch ${r}`)}return await n.json()};async function d(){try{return await c(`${s}/Houses`)}catch(r){throw console.error("Error fetching houses:",r),r}}async function u(r){try{return await c(`${s}/Houses/${r}`)}catch(e){throw console.error("Error fetching house:",e),e}}async function w(r,e,o,a,n){const t=new URLSearchParams;r&&t.append("houseId",r),e&&t.append("year",e),o&&t.append("month",o),a&&t.append("day",a),n&&t.append("type",n);try{return await c(`${s}/Entries?${t}`)}catch(i){throw console.error("Error fetching entries:",i),i}}async function l(r){try{return await c(`${s}/Entries/UpdateEntries`,{method:"POST",body:JSON.stringify(r)})}catch(e){throw console.error("Error updating entries:",e),e}}async function f(r){try{console.log(r);const e=new URLSearchParams;r.forEach(o=>e.append("ids",o)),console.log(e),await c(`${s}/Entries?${e}`,{method:"DELETE"})}catch(e){console.error("Error deleting entries:",e)}}async function g(r,e,o,a,n){try{return await c(`${s}/users/signup`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:r,password:e,email:o,houseId:a,todayOnly:n})})}catch(t){throw console.error("Error:",t),t}}async function y(r,e){try{const o=await fetch(`${s}/users/login`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:r,password:e})});if(!o.ok){const n=await o.json();throw new Error(n.message||"Login failed")}const a=await o.json();return localStorage.setItem("authToken",a.token),a}catch(o){throw console.error("Login error:",o),o}}async function E(){try{return await c(`${s}/users/validate-token`,{method:"POST"})}catch(r){throw console.error("Token validation error:",r),r}}export{u as a,w as b,f as d,d as g,y as l,g as s,l as u,E as v};
